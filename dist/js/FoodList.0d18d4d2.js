(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{510:function(e,t,a){},519:function(e,t,a){"use strict";var s=a(510);a.n(s).a},533:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"food-list"},[a("el-table",{ref:"table",attrs:{data:e.tableData,border:"",size:"small","expand-row-keys":e.expendRow,"row-key":function(t){return e.tableData.indexOf(t)}},on:{"expand-change":e.handleExpand}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left"}},[a("el-form-item",{attrs:{label:"店铺名称"}},[a("span",[e._v(e._s(s.shopName))])]),e._v(" "),a("el-form-item",{attrs:{label:"店铺地址"}},[a("span",[e._v(e._s(s.shopAddress))])]),e._v(" "),a("el-form-item",{attrs:{label:"食品种类"}},[a("span",[e._v(e._s(s.categoryName))])]),e._v(" "),a("el-form-item",{attrs:{label:"种类介绍"}},[a("span",[e._v(e._s(s.categoryDescription))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"item_id",label:"食品ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"食品名称",width:"350"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"食品介绍"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.dialogVisible=!0,e.openEdit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"page-size":20,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}}),e._v(" "),a("el-dialog",{attrs:{title:"修改食品信息",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("span",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1,e.editCancel()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1,e.editConfirm()}}},[e._v("确 定")])],1)]},proxy:!0}])},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"食品名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"食品介绍"}},[a("el-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"食品分类"}},[a("el-select",{model:{value:e.form.new_category_id,callback:function(t){e.$set(e.form,"new_category_id",t)},expression:"form.new_category_id"}},e._l(e.categoryList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"打包费"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.specs[0].packing_fee,callback:function(t){e.$set(e.form.specs[0],"packing_fee",t)},expression:"form.specs[0].packing_fee"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"价格"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.specs[0].price,callback:function(t){e.$set(e.form.specs[0],"price",t)},expression:"form.specs[0].price"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"食品图片"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseURL+"/v1/addimg/food","on-success":e.handleSuccess,"show-file-list":!1}},[e.form.image_path?a("img",{staticClass:"avatar",attrs:{src:e.imgBaseURL+e.form.image_path}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1)],1)};s._withStripped=!0;a(253);var n,r,i,o=a(98),c=a.n(o),l=(a(252),a(153)),u=a.n(l),d=a(1),p=a(62),m={name:"FoodList",components:{},data:function(){return{total:0,tableData:[],selectedRow:{},expendRow:[],dialogVisible:!1,form:{name:"",restaurant_id:"",item_id:"",category_id:"",new_category_id:"",description:"",image_path:"",specs:[{specs:"默认",packing_fee:0,price:20}]},rules:{name:[{required:!0,message:"请输入食品名称",trigger:"blur"}]},categoryList:[],baseURL:p.a,imgBaseURL:p.b}},mounted:(i=u()(c.a.mark((function e(){var t,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.$route.query.restaurant_id){e.next=8;break}return e.next=3,Object(d.o)(20,0,this.$route.query.restaurant_id);case 3:t=e.sent,this.tableData=t.data,this.total=t.data.length,e.next=16;break;case 8:return e.next=10,Object(d.o)(20,0);case 10:return a=e.sent,this.tableData=a.data,e.next=14,Object(d.n)();case 14:s=e.sent,this.total=s.data.count;case 16:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),methods:{handleCurrentChange:function(e){var t=this;this.$route.query.restaurant_id||Object(d.o)(20,20*(e-1)).then((function(e){t.tableData=e.data})).catch((function(){}))},handleExpand:(r=u()(c.a.mark((function e(t,a){var s,n,r,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a[0]){e.next=15;break}return e.next=3,Object(d.u)(t.restaurant_id);case 3:return s=e.sent,e.next=6,Object(d.k)(t.category_id);case 6:n=e.sent,t.shopName=s.data.name,t.shopAddress=s.data.address,t.categoryName=n.data.name,t.categoryDescription=n.data.description,r=this.tableData.indexOf(t),this.expendRow.push(r),e.next=18;break;case 15:i=this.tableData.indexOf(t),o=this.expendRow.indexOf(i),this.expendRow.splice(o,1);case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)}),handleDelete:function(e){var t=this;Object(d.d)(e).then((function(e){1===e.data.status?t.$message.success(e.data.success):t.$message.error(e.data.message)})).catch((function(){}))},openEdit:(n=u()(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.form.name=t.name,this.form.restaurant_id=t.restaurant_id,this.form.item_id=t.item_id,this.form.category_id=t.category_id,this.form.description=t.description,this.form.image_path=t.image_path,this.form.specs[0].packing_fee=t.specfoods[0].packing_fee,this.form.specs[0].price=t.specfoods[0].price,e.next=10,Object(d.m)(t.restaurant_id);case 10:a=e.sent,this.categoryList=a.data.category_list;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)}),handleSuccess:function(e){1===e.status?this.form.image_path=e.image_path:this.$message({type:"error",message:e.message})},editCancel:function(){},editConfirm:function(){var e=this;Object(d.B)(this.form).then((function(t){1===t.data.status?e.$message.success(t.data.success):e.$message.error(t.data.message)})).catch((function(){}))}}},f=(a(519),a(16)),h=Object(f.a)(m,s,[],!1,null,null,null);h.options.__file="src/views/FoodList.vue";t.default=h.exports}}]);