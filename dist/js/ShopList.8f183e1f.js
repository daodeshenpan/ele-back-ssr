(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{509:function(t,e,a){},518:function(t,e,a){"use strict";var s=a(509);a.n(s).a},534:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shop-list"},[a("el-table",{ref:"table",attrs:{data:t.tableData,border:"",size:"small"}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("el-form",{staticClass:"table-expand",attrs:{"label-position":"left"}},[a("el-form-item",{attrs:{label:"店铺介绍"}},[a("span",[t._v(t._s(s.description))])]),t._v(" "),a("el-form-item",{attrs:{label:"联系电话"}},[a("span",[t._v(t._s(s.phone))])]),t._v(" "),a("el-form-item",{attrs:{label:"距离"}},[a("span",[t._v(t._s(s.distance))])]),t._v(" "),a("el-form-item",{attrs:{label:"分类"}},[a("span",[t._v(t._s(s.category))])])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"店铺ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"店铺名称",width:"350"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"店铺地址"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.dialogVisible=!0,t.openEdit(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.$router.push("/addFood?restaurant_id="+e.row.id)}}},[t._v("添加商品\n                ")]),t._v(" "),a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.$router.push("/foodList?restaurant_id="+e.row.id)}}},[t._v("查看商品\n                ")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row.id)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"page-size":20,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:"修改店铺信息",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1,t.editCancel()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1,t.editConfirm()}}},[t._v("确 定")])],1)]},proxy:!0}])},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"店铺名称"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"详细地址"}},[a("el-input",{model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",t._n(e))},expression:"form.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"店铺介绍"}},[a("el-input",{model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"店铺分类"}},[a("el-cascader",{attrs:{options:t.options,props:{expandTrigger:"hover"}},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"店铺图片"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.baseURL+"/v1/addimg/shop","on-success":t.handleShopAvatarSuccess,"show-file-list":!1}},[t.form.image_path?a("img",{staticClass:"avatar",attrs:{src:t.imgBaseURL+t.form.image_path}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1)],1)};s._withStripped=!0;a(506);var n,o=a(98),i=a.n(o),r=(a(253),a(252),a(153)),l=a.n(r),c=a(1),u=a(62),d={name:"ShopList",components:{},data:function(){return{total:0,tableData:[],latitude:"0",longitude:"0",dialogVisible:!1,form:{id:"",name:"",address:"",phone:"",latitude:"",longitude:"",category:["异国料理","日韩料理"],description:"",image_path:""},options:[],currentPage:1,baseURL:u.a,imgBaseURL:u.b}},mounted:(n=l()(i.a.mark((function t(){var e,a,s,n=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.l)();case 2:return e=t.sent,this.latitude=e.data.latitude,this.longitude=e.data.longitude,t.next=7,Object(c.v)(this.latitude,this.longitude,20,0,5);case 7:return a=t.sent,this.tableData=a.data,t.next=11,Object(c.t)();case 11:return s=t.sent,this.total=s.data.count,t.next=15,Object(c.s)();case 15:t.sent.data.forEach((function(t){if(t.sub_categories.length){var e={value:t.name,label:t.name,children:[]};t.sub_categories.forEach((function(t,a){0!==a&&e.children.push({value:t.name,label:t.name})})),n.options.push(e)}}));case 17:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),methods:{handleCurrentChange:function(t){var e=this;Object(c.v)(this.latitude,this.longitude,20,20*(t-1),5).then((function(t){e.tableData=t.data})),this.currentPage=t},handleDelete:function(t){var e=this;Object(c.e)(t).then((function(t){1===t.data.status||e.$message({type:"error",message:t.data.message})})).catch((function(){}))},openEdit:function(t){this.form.id=t.id,this.form.name=t.name,this.form.address=t.address,this.form.phone=t.phone,this.form.description=t.description,this.form.image_path=t.image_path,this.form.category=t.category.split("/")},editConfirm:function(){var t=this;Array.isArray(this.form.category)&&(this.form.category=this.form.category.join("/")),Object(c.C)(this.form).then((function(e){1===e.data.status?(t.$message({type:"success",message:e.data.success}),Object(c.v)(t.latitude,t.longitude,20,20*(t.currentPage-1)).then((function(e){t.tableData=e.data}))):t.$message({type:"error",message:e.data.message})})).catch((function(){}))},handleShopAvatarSuccess:function(t){1===t.status?this.form.image_path=t.image_path:this.$message({type:"error",message:t.message})}}},m=(a(518),a(16)),f=Object(m.a)(d,s,[],!1,null,null,null);f.options.__file="src/views/ShopList.vue";e.default=f.exports}}]);