(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{513:function(e,t,a){},522:function(e,t,a){"use strict";var i=a(513);a.n(i).a},537:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add-shop"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"店铺名称",prop:"name"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"店铺地址",prop:"address"}},[a("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[a("el-input",{attrs:{maxLength:"11"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",e._n(t))},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"店铺简介",prop:"description"}},[a("el-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"推广信息",prop:"promotion_info"}},[a("el-input",{model:{value:e.form.promotion_info,callback:function(t){e.$set(e.form,"promotion_info",t)},expression:"form.promotion_info"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"店铺分类"}},[a("el-cascader",{attrs:{options:e.shopCategory,props:{expandTrigger:"hover"}},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"店铺特色"}},[a("span",[e._v("品牌保证")]),e._v(" "),a("el-switch",{model:{value:e.form.is_premium,callback:function(t){e.$set(e.form,"is_premium",t)},expression:"form.is_premium"}}),e._v(" "),a("span",[e._v("蜂鸟专送")]),e._v(" "),a("el-switch",{model:{value:e.form.delivery_mode,callback:function(t){e.$set(e.form,"delivery_mode",t)},expression:"form.delivery_mode"}}),e._v(" "),a("span",[e._v("新开店铺")]),e._v(" "),a("el-switch",{model:{value:e.form.new,callback:function(t){e.$set(e.form,"new",t)},expression:"form.new"}})],1),e._v(" "),a("el-form-item",[a("span",[e._v("外卖保")]),e._v(" "),a("el-switch",{model:{value:e.form.bao,callback:function(t){e.$set(e.form,"bao",t)},expression:"form.bao"}}),e._v(" "),a("span",[e._v("准时达")]),e._v(" "),a("el-switch",{model:{value:e.form.zhun,callback:function(t){e.$set(e.form,"zhun",t)},expression:"form.zhun"}}),e._v(" "),a("span",[e._v("开发票")]),e._v(" "),a("el-switch",{model:{value:e.form.piao,callback:function(t){e.$set(e.form,"piao",t)},expression:"form.piao"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"配送费"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.float_delivery_fee,callback:function(t){e.$set(e.form,"float_delivery_fee",t)},expression:"form.float_delivery_fee"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"起送价"}},[a("el-input-number",{attrs:{min:0},model:{value:e.form.float_minimum_order_amount,callback:function(t){e.$set(e.form,"float_minimum_order_amount",t)},expression:"form.float_minimum_order_amount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"营业时间"}},[a("el-time-select",{attrs:{"picker-options":{start:"05:30",step:"00:15",end:"23:30"},placeholder:"起始时间"},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}}),e._v(" "),a("el-time-select",{attrs:{"picker-options":{start:"05:30",step:"00:15",end:"23:30",minTime:e.form.startTime},placeholder:"结束时间"},model:{value:e.form.endTime,callback:function(t){e.$set(e.form,"endTime",t)},expression:"form.endTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传店铺头像"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseURL+"/v1/addimg/shop","on-success":e.handleShopAvatarSuccess,"show-file-list":!1}},[e.form.image_path?a("img",{staticClass:"avatar",attrs:{src:e.imgBaseURL+e.form.image_path}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"上传营业执照"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseURL+"/v1/addimg/shop","on-success":e.handleBusinessAvatarSuccess,"show-file-list":!1}},[e.form.business_license_image?a("img",{staticClass:"avatar",attrs:{src:e.imgBaseURL+e.form.business_license_image}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"上传餐饮服务许可证"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseURL+"/v1/addimg/shop","on-success":e.handleServiceAvatarSuccess,"show-file-list":!1}},[e.form.catering_service_license_image?a("img",{staticClass:"avatar",attrs:{src:e.imgBaseURL+e.form.catering_service_license_image}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"优惠活动"}},[a("el-select",{on:{change:e.selectActivity},model:{value:e.activityValue,callback:function(t){e.activityValue=t},expression:"activityValue"}},e._l(e.activityOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-table",{staticStyle:{"min-width":"600px","margin-bottom":"20px"},attrs:{data:e.form.activities}},[a("el-table-column",{attrs:{prop:"icon_name",label:"活动标题",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"活动名称",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"活动详情"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return e.removeActivity(t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")])],1)],1)],1)};i._withStripped=!0;var s=a(50),o=a(155),r=a(1),l=a(62),n={name:"AddShop",components:{MainTitle:o.a},data:function(){return{form:{name:"",address:"",phone:"",latitude:"",longitude:"",category:["异国料理","日韩料理"],float_delivery_fee:5,float_minimum_order_amount:20,description:"",promotion_info:"",is_premium:!0,delivery_mode:!0,new:!0,bao:!0,zhun:!0,piao:!0,startTime:"",endTime:"",image_path:"",business_license_image:"",catering_service_license_image:"",activities:[{icon_name:"减",name:"满减优惠",description:"满30减5，满60减8"}]},rules:{name:[{required:!0,message:"请输入餐馆名称",trigger:"blur"}],address:[{required:!0,message:"请输入餐馆地址",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话"},{type:"number",message:"电话号码必须是数字"}]},activityOptions:[{value:"满减优惠",label:"满减优惠"},{value:"优惠大酬宾",label:"优惠大酬宾"},{value:"新用户立减",label:"新用户立减"},{value:"进店领券",label:"进店领券"}],activityValue:"满减优惠",baseURL:l.a,imgBaseURL:l.b}},computed:Object(s.b)(["shopCategory"]),asyncData:function(e){var t=e.store;e.route;return t.dispatch("fetchShopCategory")},methods:{onSubmit:function(){var e=this;this.$refs.form.validate((function(t){t&&(Array.isArray(e.form.category)&&(e.form.category=e.form.category.join("/")),Object(r.c)(e.form).then((function(t){1===t.data.status?(e.$message({type:"success",message:"添加店铺成功"}),e.form={name:"",address:"",phone:"",latitude:"",longitude:"",category:["异国料理","日韩料理"],float_delivery_fee:5,float_minimum_order_amount:20,description:"",promotion_info:"",is_premium:!0,delivery_mode:!0,new:!0,bao:!0,zhun:!0,piao:!0,startTime:"",endTime:"",image_path:"",business_license_image:"",catering_service_license_image:"",activities:[{icon_name:"减",name:"满减优惠",description:"满30减5，满60减8"}]},e.form.latitude=e.latitude,e.form.longitude=e.longitude):e.$message({type:"error",message:t.data.message})})).catch((function(){})))}))},handleShopAvatarSuccess:function(e){1===e.status?this.form.image_path=e.image_path:this.$message({type:"error",message:e.message})},handleBusinessAvatarSuccess:function(e){1===e.status?this.form.business_license_image=e.image_path:this.$message({type:"error",message:e.message})},handleServiceAvatarSuccess:function(e){1===e.status?this.form.catering_service_license_image=e.image_path:this.$message({type:"error",message:e.message})},selectActivity:function(e){var t=this;this.$prompt("请输入活动内容","添加活动",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(a){var i=a.value;if(i)switch(e){case"满减优惠":t.form.activities.push({icon_name:"减",name:"满减优惠",description:i});break;case"优惠大酬宾":t.form.activities.push({icon_name:"特",name:"优惠大酬宾",description:i});break;case"新用户立减":t.form.activities.push({icon_name:"新",name:"新用户立减",description:i});break;case"进店领券":t.form.activities.push({icon_name:"领",name:"进店领券",description:i})}else t.$message({type:"error",message:"请输入活动内容"})})).catch((function(){}))},removeActivity:function(e){this.form.activities.splice(e,1)}}},m=(a(522),a(16)),c=Object(m.a)(n,i,[],!1,null,null,null);c.options.__file="src/views/AddShop.vue";t.default=c.exports}}]);